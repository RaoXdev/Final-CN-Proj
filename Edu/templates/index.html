{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Educational Resource Finder</title>

    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCidnDGbdamsCKo2-6oQthbnZvR5iocszY&callback=initMap">
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="{% static 'css/nearby_search_styles.css' %}">
    <script src="{% static 'js/script.js' %}"></script>
    <script src="{% static 'js/searchHandlers.js' %}"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <!-- Logo -->
        <a class="navbar-brand fw-bold" href="#">Educational Resource Finder</a>

        <!-- Toggler for mobile view -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar content -->
        <div class="collapse navbar-collapse" id="navbarNav">
            <!-- Left nav links -->
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">About Us</a>
                </li>
            </ul>

            <!-- Right-side tools -->
            <div class="d-flex align-items-center gap-3 flex-wrap">
                <!-- Search bar -->
                <div id="search-container">
                    <div class="input-group">
                        <input type="text" id="location-search" class="form-control"
                               placeholder="Search for a location"/>
                        <button class="btn btn-primary" id="search-button">Search</button>
                    </div>
                </div>

                <!-- Filter dropdown -->
                <div id="filter-container" class="d-flex align-items-center gap-2">
                    <div class="dropdown">
                        <button class="btn btn-outline-secondary dropdown-toggle" type="button"
                                data-bs-toggle="dropdown"
                                aria-expanded="false">
                            Filter Categories
                        </button>
                        <ul class="dropdown-menu p-3" style="min-width: 250px;">
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="library-filter" checked/>
                                    <label class="form-check-label" for="library-filter">Libraries</label>
                                </div>
                            </li>
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="universities-filter" checked/>
                                    <label class="form-check-label" for="universities-filter">Univrsitiy</label>
                                </div>
                            </li>
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="schools-filter" checked/>
                                    <label class="form-check-label" for="schools-filter">Schools</label>
                                </div>
                            </li>
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="event-filter" checked/>
                                    <label class="form-check-label" for="event-filter">Events</label>
                                </div>
                            </li>
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="bookstores-filter" checked/>
                                    <label class="form-check-label" for="bookstores-filter">Books Store</label>
                                </div>
                            </li>
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="primary-schools-filter"
                                           checked/>
                                    <label class="form-check-label" for="primary-schools-filter">Primary Schools</label>
                                </div>
                            </li>
                            <li>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="secondary-schools-filter"
                                           checked/>
                                    <label class="form-check-label" for="secondary-schools-filter">Secondary
                                        Schools</label>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <!-- Radius selector -->
                    <select class="form-select form-select-sm" id="radius-select">
                        <option value="1500">1.5km</option>
                        <option value="5000" selected>5km</option>
                        <option value="10000">10km</option>
                        <option value="15000">15km</option>
                    </select>
                </div>

                <!-- Profile/Login buttons -->
                <div>
                    {% if user.is_authenticated %}
                        <button type="button" class="btn btn-outline-primary"
                                onclick="window.location.href='{% url 'user_profile' %}'">Profile
                        </button>
                        <form method="post" action="{% url 'logout' %}" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-outline-danger ms-1">Logout</button>
                        </form>
                    {% else %}
                        <button type="button" class="btn btn-primary"
                                onclick="window.location.href='{% url 'login_register' %}'">Login/Register
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</nav>

<div class="main-container">
    <div class="left-panel">
        {#                <div id="search-container">#}
        {#                    <div class="input-group mb-2">#}
        {#                        <input type="text" id="location-search" class="form-control" placeholder="Search for a location"/>#}
        {#                        <button class="btn btn-primary" id="search-button">Search</button>#}
        {#                    </div>#}
        {#                </div>#}
        <div id="map"></div>

    </div>

    <div class="right-sidebar">
        <ul class="nav nav-tabs" id="resourceTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="libraries-tab" data-bs-toggle="tab" data-bs-target="#libraries"
                        type="button" role="tab" aria-controls="libraries" aria-selected="true">Libraries
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="events-tab" data-bs-toggle="tab" data-bs-target="#events" type="button"
                        role="tab" aria-controls="events" aria-selected="false">Events
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link " id="schools-tab" data-bs-toggle="tab" data-bs-target="#schools"
                        type="button" role="tab" aria-controls="schools" aria-selected="true">Schools
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="universities-tab" data-bs-toggle="tab" data-bs-target="#universities"
                        type="button"
                        role="tab" aria-controls="universities" aria-selected="false">Universities
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="bookstores-tab" data-bs-toggle="tab" data-bs-target="#book-stores"
                        type="button"
                        role="tab" aria-controls="book-stores" aria-selected="false">Book Stores
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link " id="primary-schools-tab" data-bs-toggle="tab"
                        data-bs-target="#primary-schools"
                        type="button" role="tab" aria-controls="primary-schools" aria-selected="true">Primary Schools
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="secondary-schools-tab" data-bs-toggle="tab"
                        data-bs-target="#secondary-schools"
                        type="button"
                        role="tab" aria-controls="secondary-schools" aria-selected="false">Secondary Schools
                </button>
            </li>
        </ul>
        <div class="tab-content pt-3" id="resourceTabsContent">
            <div class="tab-pane fade show active" id="libraries" role="tabpanel" aria-labelledby="libraries-tab">
                <div id="libraries-list">Loading...</div>
            </div>
            <div class="tab-pane fade show" id="events" role="tabpanel" aria-labelledby="events-tab">
                <div id="events-list">Loading...</div>
            </div>
            <div class="tab-pane fade show" id="universities" role="tabpanel" aria-labelledby="universities-tab">
                <div id="universities-list">Loading...</div>
            </div>
            <div class="tab-pane fade show " id="schools" role="tabpanel" aria-labelledby="schools-tab">
                <div id="schools-list">Loading...</div>
            </div>
            <div class="tab-pane fade show" id="book-stores" role="tabpanel" aria-labelledby="book-stores-tab">
                <div id="book-stores-list">Loading...</div>
            </div>
            <div class="tab-pane fade show" id="primary-schools" role="tabpanel" aria-labelledby="primary-schools-tab">
                <div id="primary-schools-list">Loading...</div>
            </div>
            <div class="tab-pane fade show " id="secondary-schools" role="tabpanel"
                 aria-labelledby="secondary-schools-tab">
                <div id="secondary-schools-list">Loading...</div>
            </div>
        </div>
    </div>
</div>


<div id="loading-spinner" style="display: none; text-align: center; margin-top: 1rem;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
<div id="book-covers-container" class="row mt-4"></div>

<!-- Include your existing <script> here with initMap, fetchResources, etc. -->

</body>
</html>
